# Docker

---

- Docker ä¸­æ–‡æ–‡æ¡£

## è¿è¡Œç¬¬ä¸€ä¸ªå®¹å™¨

> åˆ›å»ºä¸€ä¸ª mysql docker 

- [å¯¹äºå‚æ•°çš„è§£é‡Š](https://www.bilibili.com/video/BV1HP4118797?spm_id_from=333.788.player.switch&vd_source=b47817c1aa0db593f452034d53d4273a&p=4)

```shell
docker run -d \
  --name mysql1 \
  -p 3306:3306 \
  -e TZ=Asia/Shanghai \
  -e MYSQL_ROOT_PASSWORD=123 \
  mysql
```

| å‚æ•°                         | å…¨ç§°        | ä½œç”¨                     | ç¤ºä¾‹è¯´æ˜                                                     |
| ---------------------------- | ----------- | ------------------------ | ------------------------------------------------------------ |
| `docker run`                 | -           | **å¯åŠ¨å®¹å™¨**çš„æ ¸å¿ƒå‘½ä»¤   | å‘Šè¯‰ Dockerï¼šæˆ‘è¦è¿è¡Œä¸€ä¸ªå®¹å™¨                                |
| `-d`                         | `--detach`  | **åå°è¿è¡Œ**å®¹å™¨         | å®¹å™¨å¯åŠ¨åä¸ä¼šå ç”¨ä½ å½“å‰ç»ˆç«¯ï¼Œé€‚åˆæœåŠ¡ç±»å®¹å™¨å¦‚ MySQL         |
| `--name mysql1`              | -           | ç»™å®¹å™¨èµ·ä¸ª**åå­—**       | ä»¥åä½ å¯ä»¥ç”¨ `docker stop mysql1` æˆ– `docker logs mysql1` æ¥æ“ä½œå®ƒï¼Œè€Œä¸ç”¨è®°å®¹å™¨ ID |
| `-p 3306:3306`               | `--publish` | **ç«¯å£æ˜ å°„**             | æŠŠ**å®¿ä¸»æœºçš„ 3306 ç«¯å£**æ˜ å°„åˆ°**å®¹å™¨å†…çš„ 3306 ç«¯å£**ï¼Œè¿™æ ·ä½ å°±èƒ½ç”¨ `localhost:3306` è¿æ¥ MySQL |
| `-e TZ=Asia/Shanghai`        | `--env`     | è®¾ç½®**ç¯å¢ƒå˜é‡**         | è®¾ç½®å®¹å™¨çš„**æ—¶åŒº**ä¸ºä¸Šæµ·ï¼Œé¿å…æ—¶é—´å’Œç³»ç»Ÿä¸ä¸€è‡´               |
| `-e MYSQL_ROOT_PASSWORD=123` | `--env`     | è®¾ç½® root ç”¨æˆ·çš„**å¯†ç ** | MySQL é•œåƒè¦æ±‚å¿…é¡»è®¾ç½®è¿™ä¸ªå˜é‡ï¼Œå¦åˆ™å®¹å™¨å¯åŠ¨å¤±è´¥             |
| `mysql`                      | -           | ä½¿ç”¨çš„**é•œåƒå**         | Docker ä¼šä» [Docker Hub](https://hub.docker.com/_/mysql) æ‹‰å–æœ€æ–°ç‰ˆçš„ MySQL é•œåƒ |

> [!note]
>
> `-e` è¿™ä¸ªå‚æ•°éœ€è¦å¡«å†™ä»€ä¹ˆè¿™ä¸ªå…·ä½“å»ï¼Œ`Docker Hub` é‡Œé¢çœ‹æˆ‘ä»¬çš„ `mysql` çš„è¦æ±‚

<br>

## Docker å¸¸ç”¨çš„åŸºæœ¬å‘½ä»¤

| åœºæ™¯           | å‘½ä»¤                             | è¯´æ˜                     | ç¤ºä¾‹                             |
| -------------- | -------------------------------- | ------------------------ | -------------------------------- |
| **é•œåƒæ“ä½œ**   | `docker images`                  | æŸ¥çœ‹æœ¬åœ°é•œåƒ             | `docker images`                  |
|                | `docker pull <é•œåƒå>`           | æ‹‰å–é•œåƒ                 | `docker pull mysql:8.0`          |
|                | `docker rmi <é•œåƒID>`            | åˆ é™¤é•œåƒ                 | `docker rmi mysql:8.0`           |
|                | `docker build -t <å> .`         | æ„å»ºé•œåƒ                 | `docker build -t myapp .`        |
| **å®¹å™¨æ“ä½œ**   | `docker ps`                      | æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨         | `docker ps`                      |
|                | `docker ps -a`                   | æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆå«å·²åœæ­¢ï¼‰ | `docker ps -a`                   |
|                | `docker run [å‚æ•°] <é•œåƒ>`       | æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨           | `docker run -d --name web nginx` |
|                | `docker start <å®¹å™¨å>`          | å¯åŠ¨å·²å­˜åœ¨çš„å®¹å™¨         | `docker start mysql1`            |
|                | `docker stop <å®¹å™¨å>`           | åœæ­¢å®¹å™¨                 | `docker stop mysql1`             |
|                | `docker restart <å®¹å™¨å>`        | é‡å¯å®¹å™¨                 | `docker restart mysql1`          |
|                | `docker rm <å®¹å™¨å>`             | åˆ é™¤å®¹å™¨                 | `docker rm mysql1`               |
|                | `docker rename <æ—§å> <æ–°å>`    | é‡å‘½åå®¹å™¨               | `docker rename mysql1 db1`       |
| **æ—¥å¿—ä¸è°ƒè¯•** | `docker logs <å®¹å™¨å>`           | æŸ¥çœ‹å®¹å™¨æ—¥å¿—             | `docker logs mysql1`             |
|                | `docker exec -it <å®¹å™¨å> bash`  | è¿›å…¥å®¹å™¨ç»ˆç«¯             | `docker exec -it mysql1 bash`    |
|                | `docker top <å®¹å™¨å>`            | æŸ¥çœ‹å®¹å™¨è¿›ç¨‹             | `docker top mysql1`              |
| **æ•°æ®å·**     | `docker volume ls`               | æŸ¥çœ‹æ•°æ®å·               | `docker volume ls`               |
|                | `docker volume create <å·å>`    | åˆ›å»ºæ•°æ®å·               | `docker volume create mydata`    |
|                | `docker volume rm <å·å>`        | åˆ é™¤æ•°æ®å·               | `docker volume rm mydata`        |
| **ç½‘ç»œ**       | `docker network ls`              | æŸ¥çœ‹ç½‘ç»œ                 | `docker network ls`              |
|                | `docker network create <ç½‘ç»œå>` | åˆ›å»ºç½‘ç»œ                 | `docker network create mynet`    |
| **æ¸…ç†**       | `docker system prune`            | æ¸…ç†æ— ç”¨èµ„æºï¼ˆæ…ç”¨ï¼‰     | `docker system prune -f`         |
|                | `docker container prune`         | æ¸…ç†å·²åœæ­¢çš„å®¹å™¨         | `docker container prune -f`      |
|                | `docker image prune`             | æ¸…ç†æ— ç”¨é•œåƒ             | `docker image prune -f`          |

> å¸¸ç”¨ç»„åˆæ“ä½œ

| ç›®çš„                     | å‘½ä»¤                                                         |
| ------------------------ | ------------------------------------------------------------ |
| ä¸€é”®åˆ é™¤æ‰€æœ‰å·²åœæ­¢çš„å®¹å™¨ | `docker rm $(docker ps -aq)`                                 |
| ä¸€é”®åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„é•œåƒ | `docker rmi $(docker images -q)`                             |
| æŸ¥çœ‹å®¹å™¨å®æ—¶æ—¥å¿—         | `docker logs -f <å®¹å™¨å>`                                    |
| å¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨å†…         | `docker cp æœ¬åœ°è·¯å¾„ å®¹å™¨å:å®¹å™¨è·¯å¾„`                         |
| æŸ¥çœ‹å®¹å™¨å†…æ–‡ä»¶ç»“æ„       | `docker exec <å®¹å™¨å> ls /`                                  |
| æŸ¥çœ‹å¼€å¯å®¹å™¨çš„ä¿¡æ¯       | `docker ps --format "table {{.ID}}\t{{.Image}}\t{{.Ports}}\t{{.Status}}` |
| æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆå«å·²åœæ­¢ï¼‰ | `docker ps -a`                                               |

<br>

## Dockerfile

---

> [!note]
>
> `Dockerfile`å°±æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªä¸ªçš„æŒ‡ä»¤ï¼ˆInstructionï¼‰ï¼Œç”¨æŒ‡ä»¤æ¥è¯´æ˜è¦æ‰§è¡Œä»€ä¹ˆæ“ä½œæ¥æ„å»º`é•œåƒ`ã€‚
>
> å¸¸è§æŒ‡ä»¤å¦‚ä¸‹ï¼š

![image-20250802201605156](https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250802201605156.png)

> è®©æˆ‘ä»¬è·Ÿç€å®˜æ–¹ï¼Œ[æ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ª docker image](https://docs.docker.com/guides/golang/build-images/)
>
> ```bash
> git clone https://github.com/docker/docker-gs-ping
> ```
>
> è¿™é‡Œæ˜¯ä¸€ä¸ª go çš„æ¡ˆä¾‹

```dockerfile
# ? go çš„ç‰ˆæœ¬
FROM golang:1.25

# ? åç»­æ‰€æœ‰å‘½ä»¤ï¼ˆå¦‚ COPYã€RUNï¼‰éƒ½åœ¨ /usr/src/app ç›®å½•ä¸‹æ‰§è¡Œ
WORKDIR /usr/src/app

# Download Go modules
COPY go.mod go.sum ./
RUN go mod download

COPY *.go ./

# Build
# ? 1. app æ˜¯ç¼–è¯‘åç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å
# ? 2. æ˜¯ Go çš„é€šé…ç¬¦è¯­æ³•ï¼Œæ„æ€æ˜¯â€œå½“å‰ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ä¸‹çš„æ‰€æœ‰ Go åŒ…
RUN go build -v -o /usr/local/bin/app ./...

EXPOSE 8080

# Run
# * æ‰§è¡Œåˆšæ‰ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶
CMD ["app"]
```

### æ„å»ºå¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜

> [!warning]
>
> ERROR: failed to build: failed to solve: failed to fetch oauth token: Post "https://auth.docker.io/token": dial tcp [2a03:2880:f111:83:face:b00c:0:25de]:443: i/o timeout
> Failed to deploy 'docker-gs-ping Dockerfile: docker-gs-ping/Dockerfile': Image build failed with exit code 1.

â€‹	**buildx æ‹‰é•œåƒæ—¶æ˜¯`å®¢æˆ·ç«¯`ç›´æ¥å» Docker Hub æ‹¿ token**ï¼Œæ‰€ä»¥å³ä½¿ä½  `docker login` äº†ï¼Œbuildx ä¹Ÿå¯èƒ½ç»•è¿‡ daemon è‡ªå·±å»è¯·æ±‚â€”â€”è¿™å°±è§¦å‘äº† 401 æˆ–ç½‘ç»œé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ²¡è¯·è¿‡ proxy ç›´æ¥è¯·æ±‚

â€‹	ä½ éœ€è¦ç›´æ¥åœ¨buildxè°ƒç”¨æ—¶é…ç½®ä»£ç†ï¼Œä¾‹å¦‚ `HTTPS_PROXY=... docker buildx build` ç”¨äºæ­¤ç±»è¯·æ±‚ã€‚å¯é€‰åœ°ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® `BUILDKIT_NO_CLIENT_TOKEN=1` æ¥ç¦ç”¨å®¢æˆ·ç«¯è®¤è¯ï¼Œè¿™å°†å¼ºåˆ¶ buildx å°†ä½ çš„å‡­æ®å‘é€ç»™buildkitå®ˆæŠ¤è¿›ç¨‹ï¼Œè€Œä¸æ˜¯è®©buildxè‡ªå·±è¿›è¡Œè®¤è¯

> [!important]
>
> ä½ å¯ä»¥èµ‹å€¼å¯¹åº”ç»ˆç«¯çš„ç¯å¢ƒå˜é‡ç±»å‹ï¼Œç„¶åç²˜è´´åˆ°è‡ªå·±çš„ç»ˆç«¯ä¸­ï¼Œæ¥å¯åŠ¨ç»ˆç«¯çš„ä»£ç†

<img src="C:\Users\shuhe\AppData\Roaming\Typora\typora-user-images\image-20250925084503583.png" alt="image-20250925084503583" style="zoom:76%;" />

```bash
# è¿™ä¸ªè®¾ç½®çš„æ˜¯ä¸´æ—¶å˜é‡ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯é•¿æœŸæœ‰æ•ˆ
C:\Users\shuhe\Desktop> $env:HTTP_PROXY="http://127.0.0.1:7897"; $env:HTTPS_PROXY="http://127.0.0.1:7897"
```

> æˆ‘ä»¬ä¸å¦¨å†™ä¸€ä¸ªè„šæœ¬ï¼Œä¸´æ—¶ç”Ÿæ•ˆ

```powershell
# -*- coding: utf-8 -*-
$env:HTTP_PROXY = "http://127.0.0.1:7897"
$env:HTTPS_PROXY = "http://127.0.0.1:7897"
Write-Host "ä»£ç†å·²è®¾ç½®ï¼Œä»…å¯¹å½“å‰ PowerShell ä¼šè¯æœ‰æ•ˆã€‚"
```

<br>

### ä¿®æ”¹è‡ªå·±æ„å»ºçš„å®¹å™¨çš„æ ‡ç­¾

```bash
# new tag
docker image tag docker-gs-ping:latest docker-gs-ping:v1.0


### 
docker image ls

REPOSITORY                       TAG       IMAGE ID       CREATED         SIZE
docker-gs-ping                   latest    7f153fbcc0a8   6 minutes ago   1.11GB
docker-gs-ping                   v1.0      7f153fbcc0a8   6 minutes ago   1.11GB
...


# del old image
docker image rm docker-gs-ping:v1.0
```



### ä½¿ç”¨è‡ªå·±çš„é•œåƒåˆ›å»ºå®¹å™¨

```bash
docker run -d --name ping-container -p 8080:8080 docker-gs-ping:v1.0
```

> ç„¶åæˆ‘ä»¬å°±å»æµ‹è¯•ä¸€ä¸‹å§

```http
GET http://127.0.0.1:8080/
```

## Multi-stage builds && Scratch

> ä½ å¯èƒ½å‘ç°äº†ï¼Œå¯¹äºæˆ‘ä»¬è¿™ç§ä»»åŠ¡æ¥è¯´ï¼Œ`æ„å»ºå‡ºæ¥çš„ image æœªå…ä¹Ÿå¤§çš„è¿‡å¤´äº†`ï¼Œæ‰€ä»¥ï¼Œå°±ä¼šé‡‡ç”¨è¿™ä¸ªå¤šé˜¶æ®µæ„å»ºçš„æ–¹å¼æ¥å‹ç¼©ä½“ç§¯

### **Alpine ç‰ˆæœ¬** (`Dockerfile.multistage`)

- **å¤§å°**: 33.1MB
- **é€‚ç”¨åœºæ™¯**:
  - éœ€è¦è°ƒè¯•å·¥å…·çš„ç”Ÿäº§ç¯å¢ƒ
  - åº”ç”¨å¯èƒ½éœ€è¦å®‰è£…é¢å¤–åŒ…
  - éœ€è¦ shell è®¿é—®

```dockerfile
# dockerfile.umltistage
# Build stage - ä½¿ç”¨å®Œæ•´çš„ golang é•œåƒè¿›è¡Œç¼–è¯‘
FROM golang:1.25-alpine AS builder

# å®‰è£…å¿…è¦çš„ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ CGOï¼‰
RUN apk add --no-cache git

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /usr/src/app

# å¤åˆ¶ go mod æ–‡ä»¶å¹¶ä¸‹è½½ä¾èµ–
COPY go.mod go.sum ./
RUN go mod download

# å¤åˆ¶æºä»£ç 
COPY *.go ./

# ç¼–è¯‘åº”ç”¨ç¨‹åº
# CGO_ENABLED=0 åˆ›å»ºé™æ€é“¾æ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶
# -ldflags="-w -s" å‡å°äºŒè¿›åˆ¶æ–‡ä»¶å¤§å°
RUN CGO_ENABLED=0 GOOS=linux go build -a -ldflags="-w -s" -o app .

# Runtime stage - ä½¿ç”¨æœ€å°çš„åŸºç¡€é•œåƒ
FROM alpine:latest

# å®‰è£… CA è¯ä¹¦ï¼ˆå¦‚æœåº”ç”¨éœ€è¦ HTTPS è¯·æ±‚ï¼‰
RUN apk --no-cache add ca-certificates

# åˆ›å»ºé root ç”¨æˆ·æé«˜å®‰å…¨æ€§
RUN adduser -D -s /bin/sh appuser

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# ä» builder é˜¶æ®µå¤åˆ¶ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶
COPY --from=builder /usr/src/app/app .

# æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…
RUN chown appuser:appuser /app/app

# åˆ‡æ¢åˆ°é root ç”¨æˆ·
USER appuser

# æš´éœ²ç«¯å£
EXPOSE 8080

# è¿è¡Œåº”ç”¨
CMD ["./app"]
```

```bash
# æ„å»º images 
docker build -t image_name_you_like -f Dockerfile.multis
```

> ğŸ“‹ å‘½ä»¤å‚æ•°è¯´æ˜

- `docker build`: æ„å»º Docker é•œåƒçš„å‘½ä»¤
- `-t go-app-multistage`: ä¸ºé•œåƒæŒ‡å®šæ ‡ç­¾åç§°
- `-f Dockerfile.multistage`: æŒ‡å®šä½¿ç”¨çš„ Dockerfile æ–‡ä»¶åï¼ˆé»˜è®¤ä¸º Dockerfileï¼‰
- `.`: æŒ‡å®šæ„å»ºä¸Šä¸‹æ–‡ä¸ºå½“å‰ç›®å½•

### **Scratch ç‰ˆæœ¬** (`Dockerfile.scratch`)

- **å¤§å°**: 9.62MB
- **é€‚ç”¨åœºæ™¯**:
  - çº¯ç²¹çš„å¾®æœåŠ¡
  - æœ€å°æ”»å‡»é¢è¦æ±‚
  - èµ„æºæåº¦å—é™çš„ç¯å¢ƒ

<br>

## ç½‘ç»œ

---

![image-20250802204825629](https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250802204825629.png)

> [!warning]
>
> å¦‚æœæˆ‘ä»¬æŸä¸€æ¬¡å¼€æœºï¼ŒæŸä¸ªå®¹å™¨çš„ IP åœ°å€å˜åŠ¨äº†çš„è¯ï¼Œæˆ‘ä»¬æœåŠ¡å¯èƒ½å°±å‡ºé—®é¢˜äº†ï¼Œé‚£è¯·é—®ï¼Œæˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ
>
> - æˆ‘ä»¬å¯ä»¥åˆ¶ä½œä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œï¼ŒåŠ å…¥è¿™ä¸ªç½‘ç»œçš„å®¹å™¨å¯ä»¥é€šè¿‡`å®¹å™¨å`äº’ç›¸è®¿é—®

| å‘½ä»¤                        | è¯´æ˜                     | æ–‡æ¡£åœ°å€                    |
| --------------------------- | ------------------------ | --------------------------- |
| `docker network create`     | åˆ›å»ºä¸€ä¸ªç½‘ç»œ             | `docker network create`     |
| `docker network ls`         | æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œ             | `docker network ls`         |
| `docker network rm`         | åˆ é™¤æŒ‡å®šç½‘ç»œ             | `docker network rm`         |
| `docker network prune`      | æ¸…é™¤æœªä½¿ç”¨çš„ç½‘ç»œ         | `docker network prune`      |
| `docker network connect`    | ä½¿æŒ‡å®šå®¹å™¨è¿æ¥åŠ å…¥æŸç½‘ç»œ | `docker network connect`    |
| `docker network disconnect` | ä½¿æŒ‡å®šå®¹å™¨è¿æ¥ç¦»å¼€æŸç½‘ç»œ | `docker network disconnect` |
| `docker network inspect`    | æŸ¥çœ‹ç½‘ç»œè¯¦ç»†ä¿¡æ¯         | `docker network inspect`    |

<br>

## DockerCompose

---

> `DockerCompose`é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„`docker-compose.yml`æ¨¡æ¿æ–‡ä»¶ï¼ˆYAMLæ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ï¼Œå¸®
> åŠ©æˆ‘ä»¬å®ç°å¤šä¸ªç›¸äº’å…³è”çš„Dockerå®¹å™¨çš„å¿«é€Ÿéƒ¨ç½²ã€‚

![image-20250802220342782](https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250802220342782.png)

> æ¯”è¾ƒå‘½ä»¤ å’Œ Compose çš„å·®åˆ«

![image-20250802222351225](https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250802222351225.png)

### docker-compose å‘½ä»¤

> - å¦‚æœä½ çš„ compose æ–‡ä»¶ä¸æ˜¯ `docker-composer.yml` è€Œæ˜¯ä½ è‡ªå®šä¹‰çš„åå­—ï¼Œé‚£å°± -f æŒ‡å®š
> - -d æ˜¯ç”¨äºï¼Œæˆ‘ä»¬ yaml æ–‡ä»¶é‡Œé¢å¯èƒ½åˆ›å»ºäº†ä¸æ­¢ä¸€ä¸ªé…ç½®ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³å•ç‹¬å¼€å¯æŸä¸€ä¸ªï¼Œé‚£å°± -d <name>
>   - è¿™ä¸ª name å°±æ˜¯ä½  server è‡ªå·±å®šä¹‰çš„é‚£ä¸ª
>   - <img src="https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250821165519257.png" alt="image-20250821165519257" style="zoom:74%;" />

```shell
docker-compose -f <composeæ–‡ä»¶å> up -d <æœåŠ¡å>
```

### EMQX 

```yaml
services:
  emqx:
    image: emqx/emqx:latest
    container_name: emqx
    environment:
      - "EMQX_NAME=emqx"
      - "EMQX_HOST=localhost"          # å•èŠ‚ç‚¹ï¼ŒHOST å¯ä»¥éšæ„
      - "EMQX_ALLOW_ANONYMOUS=true"    # å¯é€‰ï¼šå…è®¸åŒ¿åè¿æ¥
      - "EMQX_DASHBOARD__DEFAULT_USERNAME=admin"
      - "EMQX_DASHBOARD__DEFAULT_PASSWORD=123456"
    ports:
      - "1883:1883"
      - "8083:8083"
      - "8084:8084"
      - "8883:8883"
      - "18083:18083"
    networks:
      emqx-bridge:


# LINK - Explain the use of the port
# 1883 MQTTç«¯å£
# 8083 MQTT/WebSocketç«¯å£
# 8883 MQTT/SSLç«¯å£
# 8084 MQTT/WebSocket/SSLç«¯å£
# 18083 Dashboard ç®¡ç†ç«¯å£

networks:
  emqx-bridge:
    driver: bridge

```

```bash
docker logs -f emqx
```

> test

```bash
# è¿›å…¥æ“ä½œç»ˆç«¯
docker exec -it emqx /bin/bash

# æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€
/opt/emqx/bin/emqx_ctl status

# æŸ¥çœ‹å½“å‰è¿æ¥çš„å®¢æˆ·ç«¯
/opt/emqx/bin/emqx_ctl clients list
```

<br>

### Mysql

```json
services:
  mysql:
    image: mysql:8.0
    container_name: mysql80
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD:-123456}
    ports:
      - "3306:3306"
    volumes:
      - ./mysql-data:/var/lib/mysql                # æ•°æ®æŒä¹…åŒ–
      - ./init:/docker-entrypoint-initdb.d         # å¯é€‰ï¼šåˆå§‹åŒ– SQL è„šæœ¬
    command: [
      "--character-set-server=utf8mb4",
      "--collation-server=utf8mb4_unicode_ci",
      "--default-authentication-plugin=mysql_native_password"
    ]

networks:
  IOT_NETWORK:
    driver: bridge
```



<br>

# K8s

---

![image-20250807232027917](https://raw.githubusercontent.com/MTsocute/New_Image/main/img/image-20250807232027917.png)

<br>